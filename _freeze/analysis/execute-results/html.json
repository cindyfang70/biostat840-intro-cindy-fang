{
  "hash": "894d509267bfde5825074b7808b7b8db",
  "result": {
    "markdown": "---\ntitle: \"Example analysis\"\nbibliography: references.bib\neditor: visual\n---\n\n\nLike many other graduate students, I am an avid consumer of coffee. I typically drink at least one cup of dark roast every morning with a splash of oat milk. I buy whole beans and grind them by hand, and brew using the pour over method. If I'm feeling fancy, I'll go to a cafe and order a black iced Americano (objectively the best espresso drink).\n\n::: callout-tip\n## Layering liquids\n\nYou can add coffee to a glass of oat milk by pouring slowly over the back of a spoon to create a layered drink!\n:::\n\n![An iced oat milk latte I made a few weeks ago](media/IMG_5581.png)\n\nYears of caffeine dependency have undoubtedly made me an authority on this topic, but in order to assess the current coffee zeitgeist, I will be analyzing a data set consisting of Walmart coffee listings from 500 different stores as well as consumer ratings of each coffee [@zub_2022]. I will examine whether more expensive coffees are better rated than cheaper ones.\n\nIf you are interested in learning more about coffee, or just love to drink it, read on to find out which type might be your best bet!\n\nFirst, let's take a quick look at the data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(knitr)\nlibrary(tidyverse)\nlibrary(dplyr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoffee <- read.csv(\"data/coffee-listings-from-all-walmart-stores.csv\")\ncoffee <- coffee %>%\n  select(-c(thumbnail, seller_name, weight_formatted_to_gramms)) %>%\n  filter(grepl(\"roast\", coffee_type))\n\nroastTypes <- strsplit(coffee$coffee_type, split=\",\")\nroastIndex <- lapply(roastTypes, grep, pattern=\"roast\")\nfor (i in 1:length(roastTypes)){\n  roastTypes[i] <- roastTypes[[i]][[roastIndex[[i]][[1]]]]\n}\nroastTypes <- unlist(roastTypes)\n#print(roastTypes)\nkable(head(coffee))\n```\n\n::: {.cell-output-display}\n|title                                                                             |coffee_type                | rating| reviews| price|weight     |\n|:---------------------------------------------------------------------------------|:--------------------------|------:|-------:|-----:|:----------|\n|folgers classic roast ground coffee, 40.3-ounce                                   |classic roast              |    3.8|      93| 13.92|40.3-ounce |\n|café bustelo, espresso style dark roast ground coffee, vacuum-packed 10 oz. brick |espresso,dark roast        |    4.7|     914|  3.76|10 oz      |\n|folgers classic roast ground coffee, medium roast coffee, 25.9 ounce canister     |medium roast,classic roast |    4.4|     740|  9.97|25.9 ounce |\n|great value classic roast medium ground coffee, value size, 48 oz                 |classic roast              |    4.7|    1598|  9.98|48 oz      |\n|great value classic roast medium ground coffee, 30.5 oz                           |classic roast              |    4.2|     263|  7.98|30.5 oz    |\n|caf bustelo, espresso style dark roast ground coffee, vacuum-packed 10 oz. brick  |espresso,dark roast        |    4.7|     914|  3.76|10 oz      |\n:::\n:::\n\n\n# Data dictionary\n\n**title**: the brand and name of the coffee \n\n**coffee_type**: the type of roast of the coffee\n\n**rating**: the average rating of the coffee\n\n**reviews**: the number of reviews of the coffee\n\n**price**: the retail price of the coffee\n\n**weight**: the weight for one package of the coffee\n\n# Analysis\nTo keep things simple, we will subset the data to only look at the three most common roast types: light, medium and dark.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\ncoffee$roastTypes <- roastTypes\n\ncoffee <- coffee %>%\n  filter(roastTypes %in% c(\"dark roast\", \"medium roast\", \"light roast\"))\n\np <- ggplot(coffee, aes(roastTypes))+\n  geom_bar()+\n  xlab(\"Roast Types\")\np\n```\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n**Figure 1:** a bar chart of the number of coffees in each roast type.\n\nLet's look at the distribution of the different ratings:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(coffee, aes(x=rating))+\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n**Figure 2:** A histogram of the coffee ratings.\n\nJust for fun, let's look at the mean rating for each type of roast:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nratingMeans <- coffee %>%\n  group_by(roastTypes) %>%\n  group_modify(~ as.data.frame(mean(.$rating)))\n\ncolnames(ratingMeans)[[2]] <- \"avgRating\"\nratingMeans\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 2\n# Groups:   roastTypes [3]\n  roastTypes   avgRating\n  <chr>            <dbl>\n1 dark roast        4.33\n2 light roast       3.37\n3 medium roast      4.31\n```\n:::\n:::\n\n\nWe can see that dark and medium roast are much higher rated than light roast coffees.\n\nNow, let's plot the rating of the coffee against the price, in order to see whether more expensive coffees are better.\n\n::: callout-note\nSince the coffees come in different sizes, we first need to calculate the unit price for each product.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoffee <- coffee %>%\n  mutate(numericWeight = as.numeric(gsub(\"([0-9]+).*$\", \"\\\\1\", weight))) %>%\n  mutate(unitPrice = price/numericWeight)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in mask$eval_all_mutate(quo): NAs introduced by coercion\n```\n:::\n:::\n\n\nNow, let's plot the rating of the coffee against the price, faceted by the roast type.\n\n::: column-margin\nI'm faceting by roast type because I think the three different roasts are not really interchangeable and thus should be considered individually.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- ggplot(coffee, aes(x=unitPrice, y=rating))+\n  geom_point()+\n  geom_smooth(method=lm)+\n  facet_wrap(~roastTypes)+\n  xlab(\"Unit Price\")\np2\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 48 rows containing non-finite values (stat_smooth).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 47 rows containing missing values (geom_point).\n```\n:::\n\n::: {.cell-output-display}\n![](analysis_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n**Figure 3**: Scatter plots of the coffee ratings against the unit price, faceted by the roast type.\n\n\nAcross the three different coffees, we can see that there is a slight decreasing trend. This means that a more expensive coffee does not necessarily indicate a better tasting one! Unfortunately, as we saw from the histogram of coffee ratings, the distribution of the ratings is heavily left-skewed so we actually do not have much data on lower-rated coffees. Thus, the results from this analysis should be taken with several grains of salt, until we get more data. I hope you've enjoyed this pretentious coffee data analysis!\n\nFunctions used:\n\ndplyr [@dplyr]: filter, mutate, select, group_by, group_modify\n\nggplot2 [@ggplot2]: geom_histogram, geom_point, geom_smooth, facet_wrap\n\n## References\n",
    "supporting": [
      "analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}